<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>my little astral being</title>
		<meta name="description" content="look after your own astral pet!">

		<link rel="stylesheet" href="/styles/main.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
		<script src="scripts/main.js"></script>
	</head>
	<body class="hide">
		<div id="overlay"><div id="overlay-box"></div></div>
		<div id="pet-name-dialog" title="You found an egg!">
			Your pet's name is <span id="pet-name" contenteditable="true">Fluffy</span>.
		</div>

		<canvas id="petcanvas"></canvas>

		<div class="bottom">
		<div id="menu">
			<ul>
				<li><a href="#pet-data">data</a></li>
				<li><a href="#pet-element-stats">elements</a></li>
			</ul>
			<div id="pet-data">
				<span data-showvariable="pet.name"></span> is <span data-showvariable="pet.body.species.articleName()"></span>
			</div>
			<div id="pet-element-stats">
				<table data-arraytotable="pet.soul.elements.toTableArray()"></table>
			</div>
		</div>
		</div>

		<script type="text/javascript">
		$(function()
		{
			$("#menu").tabs();

			$.ui.dialog.prototype._title = function(title)
			{
				title.html(this.options.title);
			};

			var easing = "easeInCubic";
			var duration = 1000;
			$.extend($.ui.dialog.prototype.options,
			{
				dialogClass: "no-close",
				modal: true,
				resizable: false,
				draggable: false,
				beforeClose: function()
				{
					$('.ui-widget-overlay:first')
						.clone()
						.appendTo('body')
						.show()
						.fadeOut(duration * 2, easing, function()
						{
							$(this).remove();
						});
				},
				hide: { effect: "fade", duration: duration, easing: easing },
				show: { effect: "fade", duration: duration, easing: easing }
			});

			$("#pet-name-dialog").dialog(
			{
				buttons:
				[{
					'data-setvariable':'{ "variable": "pet.name", "type": "desc", "element": "#pet-name" }',
					text: "OK",
					click: function()
					{
						$(this).dialog( "close" );
					}
				}]
			});

			for (var i = 0; i < document.styleSheets.length; i++)
			{
				ss = document.styleSheets[i];
				var tags = ["color", "border-top", "background", "background-color"];
				var petColour = ElementColours[pet.soul.highestElement.name].html;

				for (var j = 0; j < ss.cssRules.length; j++)
				{
					rules = ss.cssRules[j];
					if (typeof rules == "undefined")
					{
						continue;
					}
					if (typeof rules.style == "undefined")
					{
						continue;
					}
					if (typeof rules.style.cssText != "undefined")
					{
						if (rules.style.cssText.indexOf("lime") > -1)
						{
							rules.style.cssText = rules.style.cssText.replace("lime", petColour);
						}
					}
				}
			}
		});
		</script>
	</body>
</html>
